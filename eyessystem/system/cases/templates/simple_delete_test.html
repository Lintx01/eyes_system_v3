{% extends 'base.html' %}

{% block title %}简单删除测试{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1>简单删除功能测试</h1>
    
    <div class="alert alert-info">
        <h4>测试说明</h4>
        <p>这个页面用于测试删除功能，没有复杂的JavaScript和样式干扰。</p>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3>删除案例: CC1760426748</h3>
        </div>
        <div class="card-body">
            <form method="post" action="/teacher/clinical-cases/CC1760426748/delete/">
                {% csrf_token %}
                <div class="mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="confirm_delete" value="on" id="simpleConfirm" required>
                        <label class="form-check-label" for="simpleConfirm">
                            我确认要删除此案例
                        </label>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-danger">
                    确认删除
                </button>
                
                <a href="/teacher/clinical-cases/" class="btn btn-secondary ms-2">
                    取消
                </a>
            </form>
        </div>
    </div>
    
    <div class="mt-3">
        <h5>调试信息</h5>
        <ul>
            <li>当前用户: {{ user.username }}</li>
            <li>是否为教师: {{ user|is_teacher }}</li>
            <li>表单Action: /teacher/clinical-cases/CC1760426748/delete/</li>
        </ul>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('简单删除测试页面加载');
    
    const form = document.querySelector('form');
    const checkbox = document.getElementById('simpleConfirm');
    
    form.addEventListener('submit', function(e) {
        console.log('表单提交');
        console.log('复选框状态:', checkbox.checked);
        
        if (!checkbox.checked) {
            alert('请先勾选确认删除');
            e.preventDefault();
            return false;
        }
        
        if (!confirm('确定要删除吗？这个操作不可撤销！')) {
            e.preventDefault();
            return false;
        }
        
        console.log('表单将被提交');
    });
});
</script>
{% endblock %}